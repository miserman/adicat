<!doctype html>
<html><head>
<title>adicat chat</title>
<link rel="icon" href="../icon.png">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<script type='text/javascript' src="../core.js" async></script>
<style type="text/css">
*{margin:0;padding:0;font-size:1.05em;color:#666;word-wrap:break-word;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}
.noint{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
#background{background:url('../icon.svg') no-repeat bottom;opacity:.12;position:absolute;width:100%;height:50%;top:0;z-index:-1}
#chat_frame{position:fixed;width:100%;top:0;bottom:60px;overflow-y:auto}
#chat{position:absolute;bottom:0px;width:100%;overflow:hidden}
#chat div p{display:inline-block;padding:1em}
#input{
	position:fixed;width:100%;margin:0 0 0 -.4em;padding:1em .6em;bottom:0;
	overflow:hidden;border:none;resize:none;color:#efefef;background:#202020
}
#chat span{margin:0 .2em 0 0}
.incoming{padding:0 3em .3em 0}
.incoming p{background:#f2e5fb;border-radius:25px 25px 25px 10px}
.outgoing{padding:0 0 .3em 3em;text-align:right}
.outgoing p{background:#e0fbda;border-radius:25px 25px 10px 25px;text-align:left}
@-webkit-keyframes ddd{0%{left:0}100%{left:.8em}}@-moz-keyframes ddd{0%{left:0}100%{left:.8em}}
@-o-keyframes ddd{0%{left:0}100%{left:.8em}}@keyframes ddd{0%{left:0}100%{left:.8em}}
#indicator{
	position:fixed;bottom:60px;left:0;font-size:3.5em;
	-webkit-animation:ddd .5s infinite;-moz-animation:ddd .5s infinite;-o-animation:ddd .5s infinite;animation:ddd 1s infinite
}
</style>
</head><body>
<div id='background'></div>
<div id='chat_frame'><div id='chat'></div></div>
<p style='display:none' id='indicator' class='noint'>.</p>
<input id='input' placeholder='Message @adicat'/>
<script type="text/javascript">
window.onload=function(){
	inp.focus()
	addEvent(inp,'keydown',function(k){if(k.which===13 && inp.value!==''){send(inp.value);inp.value=''}})
	receive('','Hello!')
}
function $(e){return document.getElementById(e)}
var inp=$('input'), chat_frame=$('chat_frame'), chat=$('chat'), indicator=$('indicator'), indStat=false, log={s:'',r:''}, replies={
	greeting:['How are you?',"What's up?",'How have you been?','How was your day?','Tell me things!','Talk to me please.'],
	question:['WHAT','Mmm...','Erm','Well...','Uh',"I don't know",'QUESTIONS','let me think about that one...'],
	general:['So...','Gherga merrr','Riiight','Well anyway','...','Whelp',"I don't really know what you're talking about..."],
	happy:['Yay!','^_^V',"I'm so happy for you!","That's so exciting!",': )','Oh, good for you...'],
	sad:['Aww : (','Sorry about that : (',': (','That sucks','Well what can you do.','Pooo'],
	repeat:['Yeah what','......','Whatever.',"That's what I said...",'Yeah','Work work work']
}
function send(t){
	var e=document.createElement('div'), ep=document.createElement('p')
	e.className='outgoing'
	e.appendChild(ep)
	ep.innerText=t
	append(e)
	receive(t)
}
function receive(t,r){
	var e=document.createElement('div'), ep=document.createElement('p'), cc, re
	e.className='incoming'
	e.appendChild(ep)
	c=new adicat(t).detect()
	cc=which(c.cues)
	cc=c.string.clean===log.s ? 'repeat' : replies.hasOwnProperty(cc) ? cc : 'general'
	re=r||replies[cc].sample()
	ep.innerText=re===log.s ? replies[cc].sample() : re
	log={s:ep.innerText,r:c.string.clean}
	setTimeout(function(){typing(e)},rand(.5,.1)*t.length*100)
}
function typing(e){
	if(!indStat){
		indStat=true
		indicator.style.display=''
		setTimeout(function(){
			indicator.style.display='none'
			append(e)
			indStat=false
		},(rand(2,.2))*e.innerText.length*100)
	}
}
function append(e){
	chat.appendChild(e)
	if(chat.style.position==='' && chat.scrollHeight>chat_frame.scrollHeight) chat.style.position='relative'
	chat.lastElementChild.scrollIntoView()
}
</script></body></html>
